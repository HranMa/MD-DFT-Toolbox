# MSD Analysis Tools (Legacy)

**⚠️ IMPORTANT NOTICE:**
 These Python scripts are provided for educational/reference purposes only.
 
 **We strongly recommend using Gromacs built-in tool `gmx msd` for MSD calculations** due to its accuracy and performance advantages.
 
 *The current usage instructions were generated by ChatGPT and are for reference only.*

------

## Overview

This folder contains two legacy Python scripts designed to calculate the Mean Squared Displacement (MSD) of particles from molecular dynamics simulation trajectories:

1. **`particle-position.py`**
   - Extracts 3D coordinates of selected particles from a PDB trajectory file.
   - Saves particle coordinates into individual text files and generates 3D scatter plots for each particle as well as an overlay plot.
2. **`msd-particle-position.py`**
   - Reads the particle coordinate text files produced by `particle-position.py`.
   - Computes the MSD for each particle, taking into account periodic boundary conditions.
   - Outputs the average MSD across all particles and generates an MSD plot.

------

## Usage Instructions

### Step 1: Extract Particle Coordinates

- Run `particle-position.py` first.
- Provide your PDB trajectory file and GRO file paths inside the script (`pdb_file`, `gro_file` variables).
- When prompted, input the particle indices you want to analyze (indices can be found in your GRO file).
- The script creates an `output/` folder, where it saves each particle’s coordinates (`<particle_index>.txt`) and corresponding 3D scatter plot (`<particle_index>.png`), plus a combined plot (`all_particles.png`).

### Step 2: Calculate MSD

- Run `msd-particle-position.py`.
- This script reads all the coordinate `.txt` files from the `output/` folder.
- It computes the MSD for each particle considering periodic boundary conditions (box size defined inside the script).
- It saves the average MSD curve to `msd/msd.txt` and a plot `msd/msd.png`.
- You will be asked to confirm the list of files to process before calculation.

------

## Notes

- The box dimensions (`Lx`, `Ly`, `Lz`) in `msd-particle-position.py` should match your simulation box size for accurate periodic boundary correction.

- These scripts do **not** handle trajectory wrapping or more complex simulation conditions. For robust MSD analysis, please use:

  ```bash
  gmx msd -f trajectory.xtc -s topol.tpr -o msd.xvg
  ```

------



## Contact

For any questions or improvements, feel free to open an issue or contact the maintainer.
